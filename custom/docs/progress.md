# 點歌系統歌詞功能開發進度

## 任務清單

### 第一階段：基礎功能
- [x] 創建 progress.md 文檔記錄任務進度
- [x] 實現後端歌詞 API 端點
- [x] 實現前端歌詞顯示組件
- [x] 整合歌詞功能到播放控制區域

### 第二階段：增強功能
- [x] 支援多個歌詞提供者
- [ ] 添加載入狀態和錯誤處理
- [ ] 優化 UI 設計和動畫

### 第三階段：高級功能
- [ ] 歌詞快取機制
- [ ] 搜尋和過濾功能
- [ ] 歌詞分享功能

## 開發記錄

### 2025-09-24
- 開始歌詞功能開發
- 完成需求分析和技術方案設計
- 創建進度追蹤文檔
- **完成後端歌詞 API 端點實現**
  - 在 `ytmd_service.py` 中添加 `get_lyrics()` 方法
  - 實現多個歌詞提供者集成（按優先級）：
    - YouTube Music 原生歌詞
    - LRCLib（同步歌詞，LRC 格式）
    - Genius（純文字歌詞）
    - MusixMatch（純文字歌詞）
  - 支援 LRC 格式歌詞解析
  - 在 `routes.py` 中添加 `/lyrics/<video_id>` 和 `/current-lyrics` 端點
  - 更新前端 API 客戶端支援歌詞功能
- **完成前端歌詞顯示組件實現**
  - 在 `App.tsx` 中添加歌詞相關狀態管理
  - 實現歌詞獲取函數 `fetchLyrics()`
  - 在播放控制區域添加歌詞按鈕（Music 圖標）
  - 創建全屏歌詞 Modal 組件
  - 支援同步歌詞（帶時間標記）和純文字歌詞顯示
  - 添加載入狀態、錯誤處理和歌詞來源顯示
  - 實現可滑動的歌詞內容區域
- **修復歌詞 API 調用問題**
  - 發現前端 API 客戶端在 HTTP 404 狀態碼時會拋出異常
  - 改用直接 fetch 調用，正確處理 HTTP 狀態碼
  - 改進錯誤處理邏輯，區分網路錯誤和業務邏輯錯誤
  - 測試確認後端歌詞 API 正常工作，成功獲取歌詞數據
- **優化歌詞按鈕圖標**
  - 將歌詞按鈕圖標從 `Music` 音符改為 `FileText` 文檔圖標
  - 更直觀地表達歌詞功能，提升用戶體驗
- **修復前端代理配置問題**
  - 發現 Vite 配置中缺少歌詞 API 的代理設置
  - 在 `vite.config.ts` 中添加 `/lyrics` 和 `/current-lyrics` 代理配置
  - 測試確認前端現在可以正確調用歌詞 API
- **改進歌詞顯示模式**
  - 將歌詞從懸浮窗模式改為全屏切換模式
  - 實現完整的頁面切換體驗，類似應用內導航
  - 添加"返回主頁"按鈕，提供清晰的導航
  - 優化歌詞內容布局，增大字體和間距，提升閱讀體驗
  - 實現可滑動的歌詞內容區域，支援手動瀏覽
